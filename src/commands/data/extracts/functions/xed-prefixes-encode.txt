xed-prefixes-encode.txt/FIXUP_EOSZ_ENC()::
--------------------------------------------------------------------------------------------------------
mode16 EOSZ=0 -> EOSZ=1
mode32 EOSZ=0 -> EOSZ=2
mode64 EOSZ=0 -> EOSZ=2
otherwise -> nothing

xed-prefixes-encode.txt/FIXUP_EASZ_ENC()::
--------------------------------------------------------------------------------------------------------
mode16 EASZ=0 -> EASZ=1
mode32 EASZ=0 -> EASZ=2
mode64 EASZ=0 -> EASZ=3
otherwise -> nothing

xed-prefixes-encode.txt/FIXUP_SMODE_ENC()::
--------------------------------------------------------------------------------------------------------
mode64 SMODE=0 -> SMODE=2
mode64 SMODE=1 -> error
otherwise -> nothing

xed-prefixes-encode.txt/REMOVE_SEGMENT()::
--------------------------------------------------------------------------------------------------------
AGEN=0  -> nothing
AGEN=1  -> REMOVE_SEGMENT_AGEN1()

xed-prefixes-encode.txt/REMOVE_SEGMENT_AGEN1()::
--------------------------------------------------------------------------------------------------------
SEG0=@      -> nothing
SEG0=SEGe() -> error

xed-prefixes-encode.txt/OVERRIDE_SEG0()::
--------------------------------------------------------------------------------------------------------
SEG0=@            -> SEG_OVD=0
SEG0=XED_REG_DS   -> SEG_OVD=0
SEG0=XED_REG_CS   -> SEG_OVD=1
SEG0=XED_REG_ES   -> SEG_OVD=3
SEG0=XED_REG_FS   -> SEG_OVD=4
SEG0=XED_REG_GS   -> SEG_OVD=5
SEG0=XED_REG_SS   -> SEG_OVD=6

xed-prefixes-encode.txt/OVERRIDE_SEG1()::
--------------------------------------------------------------------------------------------------------
SEG1=@           -> SEG_OVD=0
SEG1=XED_REG_DS  -> SEG_OVD=0
SEG1=XED_REG_CS  -> SEG_OVD=1
SEG1=XED_REG_ES  -> SEG_OVD=3
SEG1=XED_REG_FS  -> SEG_OVD=4
SEG1=XED_REG_GS  -> SEG_OVD=5
SEG1=XED_REG_SS  -> SEG_OVD=6

xed-prefixes-encode.txt/REX_PREFIX_ENC()::
--------------------------------------------------------------------------------------------------------
mode64   NOREX=0  NEEDREX=1 REXW[w] REXB[b] REXX[x] REXR[r] -> 0b0100 wrxb
mode64   NOREX=0  REX=1     REXW[w] REXB[b] REXX[x] REXR[r] -> 0b0100 wrxb
mode64   NOREX=0            REXW[w]=1 REXB[b] REXX[x] REXR[r] -> 0b0100 wrxb
mode64   NOREX=0            REXW[w] REXB[b]=1 REXX[x] REXR[r] -> 0b0100 wrxb
mode64   NOREX=0            REXW[w] REXB[b] REXX[x]=1 REXR[r] -> 0b0100 wrxb
mode64   NOREX=0            REXW[w] REXB[b] REXX[x] REXR[r]=1 -> 0b0100 wrxb
mode64   NOREX=1  NEEDREX=1  -> error
mode64   NOREX=1  REX=1      -> error
mode64   NOREX=1  REXW=1     -> error
mode64   NOREX=1  REXB=1     -> error
mode64   NOREX=1  REXX=1     -> error
mode64   NOREX=1  REXR=1     -> error
mode64            NEEDREX=0 REX=0 REXW=0 REXB=0 REXX=0 REXR=0 -> nothing
mode32          REX=0 REXW=0    REXB=0    REXX=0    REXR=0       -> nothing
mode16          REX=0 REXW=0    REXB=0    REXX=0    REXR=0       -> nothing
otherwise                                                        -> error

xed-prefixes-encode.txt/PREFIX_ENC()::
--------------------------------------------------------------------------------------------------------
REP=2 -> 0xf2 no_return
REP=3 -> 0xf3 no_return
66_prefix                  -> 0x66 no_return
67_prefix                  -> 0x67 no_return
lock_prefix                -> 0xf0 no_return
fs_prefix                  -> 0x64 no_return
gs_prefix                  -> 0x65 no_return
mode64 HINT=3              -> 0x2e no_return
mode64 HINT=4              -> 0x3e no_return
not64 cs_prefix            -> 0x2e no_return
not64 HINT=3               -> 0x2e no_return
not64 ds_prefix            -> 0x3e no_return
not64 HINT=4               -> 0x3e no_return
not64 es_prefix            -> 0x26 no_return
not64 ss_prefix            -> 0x36 no_return
otherwise                  -> nothing

xed-prefixes-encode.txt/DF64()::
--------------------------------------------------------------------------------------------------------
mode16 -> nothing
mode32 -> nothing
mode64 -> DF64=1 ### EOSZ=3 -- removed EOSZ=3 because it broke encoding pop 16b dx in 64b mode.

xed-prefixes-encode.txt/OSZ_NONTERM_ENC()::
--------------------------------------------------------------------------------------------------------
VEXVALID=0 mode16 EOSZ=1        -> nothing
VEXVALID=0 mode16 EOSZ=2 DF32=1 -> nothing
VEXVALID=0 mode16 EOSZ=2 DF32=0      -> 66_prefix
VEXVALID=0 mode32 EOSZ=1  -> 66_prefix
VEXVALID=0 mode32 EOSZ=2        -> nothing
VEXVALID=0 mode64 EOSZ=1  -> 66_prefix
VEXVALID=0 mode64 EOSZ=2 DF64=1 -> error
VEXVALID=0 mode64 EOSZ=2 DF64=0 -> nothing
VEXVALID=0 mode64 EOSZ=3 DF64=1 -> nothing
VEXVALID=0 mode64 EOSZ=3 DF64=0 -> REXW=1
otherwise -> nothing

xed-prefixes-encode.txt/REFINING66()::
--------------------------------------------------------------------------------------------------------
otherwise -> nothing # norep works too

xed-prefixes-encode.txt/IGNORE66()::
--------------------------------------------------------------------------------------------------------
otherwise -> nothing

xed-prefixes-encode.txt/IMMUNE66()::
--------------------------------------------------------------------------------------------------------
mode16        -> EOSZ=2 DF32=1
otherwise     -> nothing

xed-prefixes-encode.txt/IMMUNE66_LOOP64()::
--------------------------------------------------------------------------------------------------------
otherwise -> nothing

xed-prefixes-encode.txt/IMMUNE_REXW()::
--------------------------------------------------------------------------------------------------------
otherwise -> nothing

xed-prefixes-encode.txt/CR_WIDTH()::
--------------------------------------------------------------------------------------------------------
mode16 -> DF32=1 EOSZ=2
mode32 -> nothing
mode64 -> DF64=1 EOSZ=3

xed-prefixes-encode.txt/FORCE64()::
--------------------------------------------------------------------------------------------------------
otherwise -> DF64=1 EOSZ=3

xed-prefixes-encode.txt/BRANCH_HINT()::
--------------------------------------------------------------------------------------------------------
otherwise  -> nothing
